{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { useContext, useEffect, useLayoutEffect, useMemo, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { normalizeColor, parseMetricToNum, useForwardedRef } from '../../utils';\nimport { StyledChart } from './StyledChart';\nimport { normalizeBounds, normalizeValues } from './utils';\nvar gradientMaskColor = '#ffffff'; // use constants so re-renders don't re-trigger effects\n\nvar defaultSize = {\n  height: 'small',\n  width: 'medium'\n};\nvar defaultValues = [];\nvar Chart = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      propsBounds = _ref.bounds,\n      color = _ref.color,\n      dash = _ref.dash,\n      gap = _ref.gap,\n      id = _ref.id,\n      onClick = _ref.onClick,\n      onHover = _ref.onHover,\n      propsOpacity = _ref.opacity,\n      _ref$overflow = _ref.overflow,\n      overflow = _ref$overflow === void 0 ? false : _ref$overflow,\n      pad = _ref.pad,\n      point = _ref.point,\n      round = _ref.round,\n      _ref$size = _ref.size,\n      propsSize = _ref$size === void 0 ? defaultSize : _ref$size,\n      _ref$thickness = _ref.thickness,\n      thickness = _ref$thickness === void 0 ? 'medium' : _ref$thickness,\n      _ref$type = _ref.type,\n      type = _ref$type === void 0 ? 'bar' : _ref$type,\n      _ref$values = _ref.values,\n      propsValues = _ref$values === void 0 ? defaultValues : _ref$values,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"a11yTitle\", \"bounds\", \"color\", \"dash\", \"gap\", \"id\", \"onClick\", \"onHover\", \"opacity\", \"overflow\", \"pad\", \"point\", \"round\", \"size\", \"thickness\", \"type\", \"values\"]);\n\n  var containerRef = useForwardedRef(ref);\n  var theme = useContext(ThemeContext) || defaultProps.theme; // normalize variables\n\n  var values = useMemo(function () {\n    return normalizeValues(propsValues);\n  }, [propsValues]);\n  var bounds = useMemo(function () {\n    return normalizeBounds(propsBounds, values);\n  }, [propsBounds, values]);\n  var strokeWidth = useMemo(function () {\n    return parseMetricToNum(theme.global.edgeSize[thickness] || thickness);\n  }, [theme.global.edgeSize, thickness]);\n  var inset = useMemo(function () {\n    var result = [0, 0, 0, 0];\n\n    if (pad) {\n      if (pad.horizontal) {\n        var padSize = parseMetricToNum(theme.global.edgeSize[pad.horizontal]);\n        result[0] += padSize;\n        result[2] += padSize;\n      }\n\n      if (pad.vertical) {\n        var _padSize = parseMetricToNum(theme.global.edgeSize[pad.vertical]);\n\n        result[1] += _padSize;\n        result[3] += _padSize;\n      }\n\n      if (typeof pad === 'string') {\n        var _padSize2 = parseMetricToNum(theme.global.edgeSize[pad]);\n\n        result = [_padSize2, _padSize2, _padSize2, _padSize2];\n      }\n    }\n\n    return result;\n  }, [pad, theme.global.edgeSize]);\n  var strokeDasharray = useMemo(function () {\n    if (dash) {\n      if (round) return strokeWidth + \" \" + strokeWidth * 1.5;\n      return strokeWidth * 2 + \" \" + strokeWidth / 2;\n    }\n\n    return undefined;\n  }, [dash, round, strokeWidth]); // potentially dynamic sizing\n\n  var _useState = useState([0, 0]),\n      containerSize = _useState[0],\n      setContainerSize = _useState[1];\n\n  var needContainerSize = useMemo(function () {\n    return propsSize && (propsSize === 'full' || propsSize === 'fill' || propsSize.height === 'full' || propsSize.height === 'fill' || propsSize.width === 'full' || propsSize.width === 'fill');\n  }, [propsSize]);\n  var size = useMemo(function () {\n    var gapWidth = gap ? parseMetricToNum(theme.global.edgeSize[gap] || gap) : strokeWidth; // autoWidth is how wide we'd pefer\n\n    var autoWidth = strokeWidth * values.length + (values.length - 1) * gapWidth;\n    var sizeWidth = typeof propsSize === 'string' ? propsSize : propsSize.width || defaultSize.width;\n    var width;\n\n    if (sizeWidth === 'full' || sizeWidth === 'fill') {\n      width = containerSize[0];\n    } else if (sizeWidth === 'auto') {\n      width = autoWidth;\n    } else {\n      width = parseMetricToNum(theme.global.size[sizeWidth] || sizeWidth);\n    }\n\n    var sizeHeight = typeof propsSize === 'string' ? propsSize : propsSize.height || defaultSize.height;\n    var height;\n\n    if (sizeHeight === 'full' || sizeHeight === 'fill') {\n      height = containerSize[1];\n    } else {\n      height = parseMetricToNum(theme.global.size[sizeHeight] || sizeHeight);\n    }\n\n    return [width, height];\n  }, [containerSize, gap, propsSize, strokeWidth, theme.global.edgeSize, theme.global.size, values]);\n  var scale = useMemo(function () {\n    return [(size[0] - (inset[0] + inset[2])) / (bounds[0][1] - bounds[0][0]), (size[1] - (inset[1] + inset[3])) / (bounds[1][1] - bounds[1][0])];\n  }, [bounds, inset, size]);\n  var viewBounds = useMemo(function () {\n    return overflow ? [0, 0, size[0], size[1]] : [-(strokeWidth / 2), -(strokeWidth / 2), size[0] + strokeWidth, size[1] + strokeWidth];\n  }, [overflow, size, strokeWidth]);\n  var useGradient = color && Array.isArray(color); // set container size when we get ref or when size changes\n\n  useLayoutEffect(function () {\n    if (containerRef.current && needContainerSize) {\n      var containerNode = containerRef.current;\n\n      if (containerNode) {\n        var parentNode = containerNode.parentNode;\n\n        if (parentNode) {\n          var rect = parentNode.getBoundingClientRect();\n\n          if (rect.width !== containerSize[0] || rect.height !== containerSize[1]) {\n            setContainerSize([rect.width, rect.height]);\n          }\n        }\n      }\n    }\n  }, [containerRef, containerSize, needContainerSize]); // container size, if needed\n\n  useEffect(function () {\n    var onResize = function onResize() {\n      var parentNode = containerRef.current.parentNode;\n      var rect = parentNode.getBoundingClientRect();\n      setContainerSize([rect.width, rect.height]);\n    };\n\n    if (needContainerSize) {\n      window.addEventListener('resize', onResize);\n      return function () {\n        return window.removeEventListener('resize', onResize);\n      };\n    }\n\n    return undefined;\n  }, [containerRef, needContainerSize]); // Converts values to drawing coordinates.\n  // Takes into account the bounds, any inset, and the scale.\n\n  var valueToCoordinate = function valueToCoordinate(xValue, yValue) {\n    return [(xValue - bounds[0][0]) * scale[0] + inset[0], size[1] - ((yValue - bounds[1][0]) * scale[1] + inset[1])];\n  };\n\n  var renderBars = function renderBars() {\n    return (values || []).filter(function (_ref2) {\n      var value = _ref2.value;\n      return value[1] !== undefined;\n    }).map(function (valueArg, index) {\n      var valueColor = valueArg.color,\n          label = valueArg.label,\n          valueOnHover = valueArg.onHover,\n          valueOpacity = valueArg.opacity,\n          valueThickness = valueArg.thickness,\n          value = valueArg.value,\n          valueRest = _objectWithoutPropertiesLoose(valueArg, [\"color\", \"label\", \"onHover\", \"opacity\", \"thickness\", \"value\"]);\n\n      var key = \"p-\" + index; // Math.min/max are to handle negative values\n\n      var bottom = value.length === 2 ? Math.min(Math.max(0, bounds[1][0]), value[1]) : Math.min(value[1], value[2]);\n      var top = value.length === 2 ? Math.max(Math.min(0, bounds[1][1]), value[1]) : Math.max(value[1], value[2]);\n      var d = \"M \" + valueToCoordinate(value[0], bottom).join(',') + (\" L \" + valueToCoordinate(value[0], top).join(','));\n      var hoverProps;\n\n      if (valueOnHover) {\n        hoverProps = {\n          onMouseOver: function onMouseOver() {\n            return valueOnHover(true);\n          },\n          onMouseLeave: function onMouseLeave() {\n            return valueOnHover(false);\n          }\n        };\n      }\n\n      var clickProps;\n\n      if (onClick) {\n        clickProps = {\n          onClick: onClick\n        };\n      }\n\n      return /*#__PURE__*/React.createElement(\"g\", {\n        key: key,\n        fill: \"none\",\n        stroke: valueColor ? normalizeColor(valueColor, theme) : undefined,\n        strokeWidth: valueThickness ? parseMetricToNum(theme.global.edgeSize[valueThickness] || valueThickness) : undefined,\n        opacity: valueOpacity && theme.global.opacity[valueOpacity] || valueOpacity\n      }, /*#__PURE__*/React.createElement(\"title\", null, label), /*#__PURE__*/React.createElement(\"path\", _extends({\n        d: d\n      }, hoverProps, clickProps, valueRest, {\n        strokeDasharray: strokeDasharray\n      })));\n    });\n  };\n\n  var renderLine = function renderLine() {\n    var d = '';\n    var d2 = '';\n    (values || []).filter(function (_ref3) {\n      var value = _ref3.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref4) {\n      var value = _ref4.value;\n      d += (d ? ' L' : 'M') + \" \" + valueToCoordinate(value[0], value[1]).join(',');\n\n      if (value[2] !== undefined) {\n        d2 += (d2 ? ' L' : 'M') + \" \" + valueToCoordinate(value[0], value[2]).join(',');\n      }\n    });\n    var hoverProps;\n\n    if (onHover) {\n      hoverProps = {\n        onMouseOver: function onMouseOver() {\n          return onHover(true);\n        },\n        onMouseLeave: function onMouseLeave() {\n          return onHover(false);\n        }\n      };\n    }\n\n    var clickProps;\n\n    if (onClick) {\n      clickProps = {\n        onClick: onClick\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(\"g\", {\n      fill: \"none\"\n    }, /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d\n    }, hoverProps, clickProps, {\n      strokeDasharray: strokeDasharray\n    })), d2 && /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d2\n    }, hoverProps, clickProps, {\n      strokeDasharray: strokeDasharray\n    })));\n  };\n\n  var renderArea = function renderArea() {\n    var d = '';\n    (values || []).filter(function (_ref5) {\n      var value = _ref5.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref6, index) {\n      var value = _ref6.value;\n      d += (!index ? 'M' : ' L') + \" \" + valueToCoordinate(value[0], value[value.length === 2 ? 1 : 2]).join(',');\n    });\n    (values || []).reverse().filter(function (_ref7) {\n      var value = _ref7.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref8) {\n      var value = _ref8.value;\n      d += \" L \" + valueToCoordinate(value[0], // Math.max() is to account for value[1] being negative\n      value.length === 2 ? Math.max(0, bounds[1][0]) : value[1]).join(',');\n    });\n\n    if (d.length > 0) {\n      d += ' Z';\n    }\n\n    var hoverProps;\n\n    if (onHover) {\n      hoverProps = {\n        onMouseOver: function onMouseOver() {\n          return onHover(true);\n        },\n        onMouseLeave: function onMouseLeave() {\n          return onHover(false);\n        }\n      };\n    }\n\n    var clickProps;\n\n    if (onClick) {\n      clickProps = {\n        onClick: onClick\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d\n    }, hoverProps, clickProps)));\n  };\n\n  var renderPoints = function renderPoints() {\n    return (values || []).filter(function (_ref9) {\n      var value = _ref9.value;\n      return value[1] !== undefined;\n    }).map(function (valueArg, index) {\n      var valueColor = valueArg.color,\n          label = valueArg.label,\n          valueOnHover = valueArg.onHover,\n          valueOpacity = valueArg.opacity,\n          valueThickness = valueArg.thickness,\n          value = valueArg.value,\n          valueRest = _objectWithoutPropertiesLoose(valueArg, [\"color\", \"label\", \"onHover\", \"opacity\", \"thickness\", \"value\"]);\n\n      var key = \"p-\" + index;\n      var hoverProps;\n\n      if (valueOnHover) {\n        hoverProps = {\n          onMouseOver: function onMouseOver() {\n            return valueOnHover(true);\n          },\n          onMouseLeave: function onMouseLeave() {\n            return valueOnHover(false);\n          }\n        };\n      }\n\n      var clickProps;\n\n      if (onClick) {\n        clickProps = {\n          onClick: onClick\n        };\n      }\n\n      var width = valueThickness ? parseMetricToNum(theme.global.edgeSize[valueThickness] || valueThickness) : strokeWidth;\n\n      var renderPoint = function renderPoint(valueX, valueY) {\n        var props = _extends({}, hoverProps, clickProps, valueRest);\n\n        var _valueToCoordinate = valueToCoordinate(valueX, valueY),\n            cx = _valueToCoordinate[0],\n            cy = _valueToCoordinate[1];\n\n        var off = width / 2;\n        if (point === 'circle' || !point && round) return /*#__PURE__*/React.createElement(\"circle\", _extends({\n          cx: cx,\n          cy: cy,\n          r: off\n        }, props));\n        var d;\n        if (point === 'diamond') d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + cy + \" L \" + cx + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + cy + \" Z\";else if (point === 'star') {\n          var off1 = off / 3;\n          var off2 = off1 * 2;\n          d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx - off2) + \" \" + (cy + off) + \" L \" + (cx + off) + \" \" + (cy - off1) + \" L \" + (cx - off) + \" \" + (cy - off1) + \" L \" + (cx + off2) + \" \" + (cy + off) + \" Z\";\n        } else if (point === 'triangle') d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + (cy + off) + \" Z\";else if (point === 'triangleDown') d = \"M \" + (cx - off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy - off) + \" L \" + cx + \" \" + (cy + off) + \" Z\"; // square\n        else d = \"M \" + (cx - off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + (cy + off) + \" Z\";\n        return /*#__PURE__*/React.createElement(\"path\", {\n          d: d\n        });\n      };\n\n      return /*#__PURE__*/React.createElement(\"g\", {\n        key: key,\n        stroke: \"none\",\n        fill: valueColor ? normalizeColor(valueColor, theme) : undefined,\n        opacity: valueOpacity && theme.global.opacity[valueOpacity] || valueOpacity\n      }, /*#__PURE__*/React.createElement(\"title\", null, label), renderPoint(value[0], value[1]), value[2] !== undefined && renderPoint(value[0], value[2]));\n    });\n  };\n\n  var contents;\n\n  if (type === 'bar') {\n    contents = renderBars();\n  } else if (type === 'line') {\n    contents = renderLine();\n  } else if (type === 'area') {\n    contents = renderArea();\n  } else if (type === 'point') {\n    contents = renderPoints();\n  }\n\n  var viewBox = viewBounds.join(' ');\n  var colorName;\n\n  if (!useGradient) {\n    if (color && color.color) colorName = color.color;else if (color) colorName = color;else if (theme.chart && theme.chart.color) colorName = theme.chart.color;\n  }\n\n  var opacity = propsOpacity || color && color.opacity ? theme.global.opacity[propsOpacity || color.opacity] || propsOpacity || color.opacity : undefined;\n  var stroke;\n\n  if (type !== 'point') {\n    if (useGradient) stroke = gradientMaskColor;else stroke = normalizeColor(colorName, theme);\n  } else stroke = 'none';\n\n  var fill;\n\n  if (type === 'point' || type === 'area') {\n    if (useGradient) fill = gradientMaskColor;else fill = normalizeColor(colorName, theme);\n  } else fill = 'none';\n\n  var drawing = /*#__PURE__*/React.createElement(\"g\", {\n    stroke: stroke,\n    strokeWidth: type !== 'point' ? strokeWidth : undefined,\n    fill: fill,\n    strokeLinecap: round ? 'round' : 'butt',\n    strokeLinejoin: round ? 'round' : 'miter',\n    opacity: opacity\n  }, contents);\n  var defs;\n  var gradientRect;\n\n  if (useGradient && size[1]) {\n    var uniqueGradientId = color.map(function (element) {\n      return element.color;\n    }).join('-');\n    var gradientId = uniqueGradientId + \"-\" + id + \"-gradient\";\n    var maskId = uniqueGradientId + \"-\" + id + \"-mask\";\n    defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n      id: gradientId,\n      x1: 0,\n      y1: 0,\n      x2: 0,\n      y2: 1\n    }, color.sort(function (c1, c2) {\n      return c2.value - c1.value;\n    }).map(function (_ref10) {\n      var value = _ref10.value,\n          gradientColor = _ref10.color;\n      return /*#__PURE__*/React.createElement(\"stop\", {\n        key: value,\n        offset: // TODO:\n        (size[1] - (value - bounds[1][0]) * scale[1]) / size[1],\n        stopColor: normalizeColor(gradientColor, theme)\n      });\n    })), /*#__PURE__*/React.createElement(\"mask\", {\n      id: maskId\n    }, drawing));\n    gradientRect = /*#__PURE__*/React.createElement(\"rect\", {\n      x: viewBounds[0],\n      y: viewBounds[1],\n      width: viewBounds[2],\n      height: viewBounds[3],\n      fill: \"url(#\" + gradientId + \")\",\n      mask: \"url(#\" + maskId + \")\"\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(StyledChart, _extends({\n    ref: containerRef,\n    id: id,\n    \"aria-label\": a11yTitle,\n    viewBox: viewBox,\n    preserveAspectRatio: \"none\",\n    width: size === 'full' ? '100%' : size[0],\n    height: size === 'full' ? '100%' : size[1],\n    typeProp: type // prevent adding to DOM\n\n  }, rest), defs, useGradient ? gradientRect : drawing);\n});\nChart.displayName = 'Chart';\nvar ChartDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  ChartDoc = require('./doc').doc(Chart); // eslint-disable-line global-require\n}\n\nvar ChartWrapper = ChartDoc || Chart;\nexport { ChartWrapper as Chart };","map":{"version":3,"sources":["/Users/jeffreynaef/go/src/github.com/n3wscott/sockeye/frontend/node_modules/grommet/es6/components/Chart/Chart.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","useContext","useEffect","useLayoutEffect","useMemo","useState","ThemeContext","defaultProps","normalizeColor","parseMetricToNum","useForwardedRef","StyledChart","normalizeBounds","normalizeValues","gradientMaskColor","defaultSize","height","width","defaultValues","Chart","forwardRef","_ref","ref","a11yTitle","propsBounds","bounds","color","dash","gap","id","onClick","onHover","propsOpacity","opacity","_ref$overflow","overflow","pad","point","round","_ref$size","size","propsSize","_ref$thickness","thickness","_ref$type","type","_ref$values","values","propsValues","rest","containerRef","theme","strokeWidth","global","edgeSize","inset","result","horizontal","padSize","vertical","_padSize","_padSize2","strokeDasharray","undefined","_useState","containerSize","setContainerSize","needContainerSize","gapWidth","autoWidth","sizeWidth","sizeHeight","scale","viewBounds","useGradient","Array","isArray","current","containerNode","parentNode","rect","getBoundingClientRect","onResize","window","addEventListener","removeEventListener","valueToCoordinate","xValue","yValue","renderBars","filter","_ref2","value","map","valueArg","index","valueColor","label","valueOnHover","valueOpacity","valueThickness","valueRest","bottom","Math","min","max","top","d","join","hoverProps","onMouseOver","onMouseLeave","clickProps","createElement","fill","stroke","renderLine","d2","_ref3","forEach","_ref4","renderArea","_ref5","_ref6","reverse","_ref7","_ref8","renderPoints","_ref9","renderPoint","valueX","valueY","props","_valueToCoordinate","cx","cy","off","r","off1","off2","contents","viewBox","colorName","chart","drawing","strokeLinecap","strokeLinejoin","defs","gradientRect","uniqueGradientId","element","gradientId","maskId","x1","y1","x2","y2","sort","c1","c2","_ref10","gradientColor","offset","stopColor","x","y","mask","preserveAspectRatio","typeProp","displayName","ChartDoc","process","env","NODE_ENV","require","doc","ChartWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useContext, useEffect, useLayoutEffect, useMemo, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { normalizeColor, parseMetricToNum, useForwardedRef } from '../../utils';\nimport { StyledChart } from './StyledChart';\nimport { normalizeBounds, normalizeValues } from './utils';\nvar gradientMaskColor = '#ffffff'; // use constants so re-renders don't re-trigger effects\n\nvar defaultSize = {\n  height: 'small',\n  width: 'medium'\n};\nvar defaultValues = [];\nvar Chart = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      propsBounds = _ref.bounds,\n      color = _ref.color,\n      dash = _ref.dash,\n      gap = _ref.gap,\n      id = _ref.id,\n      onClick = _ref.onClick,\n      onHover = _ref.onHover,\n      propsOpacity = _ref.opacity,\n      _ref$overflow = _ref.overflow,\n      overflow = _ref$overflow === void 0 ? false : _ref$overflow,\n      pad = _ref.pad,\n      point = _ref.point,\n      round = _ref.round,\n      _ref$size = _ref.size,\n      propsSize = _ref$size === void 0 ? defaultSize : _ref$size,\n      _ref$thickness = _ref.thickness,\n      thickness = _ref$thickness === void 0 ? 'medium' : _ref$thickness,\n      _ref$type = _ref.type,\n      type = _ref$type === void 0 ? 'bar' : _ref$type,\n      _ref$values = _ref.values,\n      propsValues = _ref$values === void 0 ? defaultValues : _ref$values,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"a11yTitle\", \"bounds\", \"color\", \"dash\", \"gap\", \"id\", \"onClick\", \"onHover\", \"opacity\", \"overflow\", \"pad\", \"point\", \"round\", \"size\", \"thickness\", \"type\", \"values\"]);\n\n  var containerRef = useForwardedRef(ref);\n  var theme = useContext(ThemeContext) || defaultProps.theme; // normalize variables\n\n  var values = useMemo(function () {\n    return normalizeValues(propsValues);\n  }, [propsValues]);\n  var bounds = useMemo(function () {\n    return normalizeBounds(propsBounds, values);\n  }, [propsBounds, values]);\n  var strokeWidth = useMemo(function () {\n    return parseMetricToNum(theme.global.edgeSize[thickness] || thickness);\n  }, [theme.global.edgeSize, thickness]);\n  var inset = useMemo(function () {\n    var result = [0, 0, 0, 0];\n\n    if (pad) {\n      if (pad.horizontal) {\n        var padSize = parseMetricToNum(theme.global.edgeSize[pad.horizontal]);\n        result[0] += padSize;\n        result[2] += padSize;\n      }\n\n      if (pad.vertical) {\n        var _padSize = parseMetricToNum(theme.global.edgeSize[pad.vertical]);\n\n        result[1] += _padSize;\n        result[3] += _padSize;\n      }\n\n      if (typeof pad === 'string') {\n        var _padSize2 = parseMetricToNum(theme.global.edgeSize[pad]);\n\n        result = [_padSize2, _padSize2, _padSize2, _padSize2];\n      }\n    }\n\n    return result;\n  }, [pad, theme.global.edgeSize]);\n  var strokeDasharray = useMemo(function () {\n    if (dash) {\n      if (round) return strokeWidth + \" \" + strokeWidth * 1.5;\n      return strokeWidth * 2 + \" \" + strokeWidth / 2;\n    }\n\n    return undefined;\n  }, [dash, round, strokeWidth]); // potentially dynamic sizing\n\n  var _useState = useState([0, 0]),\n      containerSize = _useState[0],\n      setContainerSize = _useState[1];\n\n  var needContainerSize = useMemo(function () {\n    return propsSize && (propsSize === 'full' || propsSize === 'fill' || propsSize.height === 'full' || propsSize.height === 'fill' || propsSize.width === 'full' || propsSize.width === 'fill');\n  }, [propsSize]);\n  var size = useMemo(function () {\n    var gapWidth = gap ? parseMetricToNum(theme.global.edgeSize[gap] || gap) : strokeWidth; // autoWidth is how wide we'd pefer\n\n    var autoWidth = strokeWidth * values.length + (values.length - 1) * gapWidth;\n    var sizeWidth = typeof propsSize === 'string' ? propsSize : propsSize.width || defaultSize.width;\n    var width;\n\n    if (sizeWidth === 'full' || sizeWidth === 'fill') {\n      width = containerSize[0];\n    } else if (sizeWidth === 'auto') {\n      width = autoWidth;\n    } else {\n      width = parseMetricToNum(theme.global.size[sizeWidth] || sizeWidth);\n    }\n\n    var sizeHeight = typeof propsSize === 'string' ? propsSize : propsSize.height || defaultSize.height;\n    var height;\n\n    if (sizeHeight === 'full' || sizeHeight === 'fill') {\n      height = containerSize[1];\n    } else {\n      height = parseMetricToNum(theme.global.size[sizeHeight] || sizeHeight);\n    }\n\n    return [width, height];\n  }, [containerSize, gap, propsSize, strokeWidth, theme.global.edgeSize, theme.global.size, values]);\n  var scale = useMemo(function () {\n    return [(size[0] - (inset[0] + inset[2])) / (bounds[0][1] - bounds[0][0]), (size[1] - (inset[1] + inset[3])) / (bounds[1][1] - bounds[1][0])];\n  }, [bounds, inset, size]);\n  var viewBounds = useMemo(function () {\n    return overflow ? [0, 0, size[0], size[1]] : [-(strokeWidth / 2), -(strokeWidth / 2), size[0] + strokeWidth, size[1] + strokeWidth];\n  }, [overflow, size, strokeWidth]);\n  var useGradient = color && Array.isArray(color); // set container size when we get ref or when size changes\n\n  useLayoutEffect(function () {\n    if (containerRef.current && needContainerSize) {\n      var containerNode = containerRef.current;\n\n      if (containerNode) {\n        var parentNode = containerNode.parentNode;\n\n        if (parentNode) {\n          var rect = parentNode.getBoundingClientRect();\n\n          if (rect.width !== containerSize[0] || rect.height !== containerSize[1]) {\n            setContainerSize([rect.width, rect.height]);\n          }\n        }\n      }\n    }\n  }, [containerRef, containerSize, needContainerSize]); // container size, if needed\n\n  useEffect(function () {\n    var onResize = function onResize() {\n      var parentNode = containerRef.current.parentNode;\n      var rect = parentNode.getBoundingClientRect();\n      setContainerSize([rect.width, rect.height]);\n    };\n\n    if (needContainerSize) {\n      window.addEventListener('resize', onResize);\n      return function () {\n        return window.removeEventListener('resize', onResize);\n      };\n    }\n\n    return undefined;\n  }, [containerRef, needContainerSize]); // Converts values to drawing coordinates.\n  // Takes into account the bounds, any inset, and the scale.\n\n  var valueToCoordinate = function valueToCoordinate(xValue, yValue) {\n    return [(xValue - bounds[0][0]) * scale[0] + inset[0], size[1] - ((yValue - bounds[1][0]) * scale[1] + inset[1])];\n  };\n\n  var renderBars = function renderBars() {\n    return (values || []).filter(function (_ref2) {\n      var value = _ref2.value;\n      return value[1] !== undefined;\n    }).map(function (valueArg, index) {\n      var valueColor = valueArg.color,\n          label = valueArg.label,\n          valueOnHover = valueArg.onHover,\n          valueOpacity = valueArg.opacity,\n          valueThickness = valueArg.thickness,\n          value = valueArg.value,\n          valueRest = _objectWithoutPropertiesLoose(valueArg, [\"color\", \"label\", \"onHover\", \"opacity\", \"thickness\", \"value\"]);\n\n      var key = \"p-\" + index; // Math.min/max are to handle negative values\n\n      var bottom = value.length === 2 ? Math.min(Math.max(0, bounds[1][0]), value[1]) : Math.min(value[1], value[2]);\n      var top = value.length === 2 ? Math.max(Math.min(0, bounds[1][1]), value[1]) : Math.max(value[1], value[2]);\n      var d = \"M \" + valueToCoordinate(value[0], bottom).join(',') + (\" L \" + valueToCoordinate(value[0], top).join(','));\n      var hoverProps;\n\n      if (valueOnHover) {\n        hoverProps = {\n          onMouseOver: function onMouseOver() {\n            return valueOnHover(true);\n          },\n          onMouseLeave: function onMouseLeave() {\n            return valueOnHover(false);\n          }\n        };\n      }\n\n      var clickProps;\n\n      if (onClick) {\n        clickProps = {\n          onClick: onClick\n        };\n      }\n\n      return /*#__PURE__*/React.createElement(\"g\", {\n        key: key,\n        fill: \"none\",\n        stroke: valueColor ? normalizeColor(valueColor, theme) : undefined,\n        strokeWidth: valueThickness ? parseMetricToNum(theme.global.edgeSize[valueThickness] || valueThickness) : undefined,\n        opacity: valueOpacity && theme.global.opacity[valueOpacity] || valueOpacity\n      }, /*#__PURE__*/React.createElement(\"title\", null, label), /*#__PURE__*/React.createElement(\"path\", _extends({\n        d: d\n      }, hoverProps, clickProps, valueRest, {\n        strokeDasharray: strokeDasharray\n      })));\n    });\n  };\n\n  var renderLine = function renderLine() {\n    var d = '';\n    var d2 = '';\n    (values || []).filter(function (_ref3) {\n      var value = _ref3.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref4) {\n      var value = _ref4.value;\n      d += (d ? ' L' : 'M') + \" \" + valueToCoordinate(value[0], value[1]).join(',');\n\n      if (value[2] !== undefined) {\n        d2 += (d2 ? ' L' : 'M') + \" \" + valueToCoordinate(value[0], value[2]).join(',');\n      }\n    });\n    var hoverProps;\n\n    if (onHover) {\n      hoverProps = {\n        onMouseOver: function onMouseOver() {\n          return onHover(true);\n        },\n        onMouseLeave: function onMouseLeave() {\n          return onHover(false);\n        }\n      };\n    }\n\n    var clickProps;\n\n    if (onClick) {\n      clickProps = {\n        onClick: onClick\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(\"g\", {\n      fill: \"none\"\n    }, /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d\n    }, hoverProps, clickProps, {\n      strokeDasharray: strokeDasharray\n    })), d2 && /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d2\n    }, hoverProps, clickProps, {\n      strokeDasharray: strokeDasharray\n    })));\n  };\n\n  var renderArea = function renderArea() {\n    var d = '';\n    (values || []).filter(function (_ref5) {\n      var value = _ref5.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref6, index) {\n      var value = _ref6.value;\n      d += (!index ? 'M' : ' L') + \" \" + valueToCoordinate(value[0], value[value.length === 2 ? 1 : 2]).join(',');\n    });\n    (values || []).reverse().filter(function (_ref7) {\n      var value = _ref7.value;\n      return value[1] !== undefined;\n    }).forEach(function (_ref8) {\n      var value = _ref8.value;\n      d += \" L \" + valueToCoordinate(value[0], // Math.max() is to account for value[1] being negative\n      value.length === 2 ? Math.max(0, bounds[1][0]) : value[1]).join(',');\n    });\n\n    if (d.length > 0) {\n      d += ' Z';\n    }\n\n    var hoverProps;\n\n    if (onHover) {\n      hoverProps = {\n        onMouseOver: function onMouseOver() {\n          return onHover(true);\n        },\n        onMouseLeave: function onMouseLeave() {\n          return onHover(false);\n        }\n      };\n    }\n\n    var clickProps;\n\n    if (onClick) {\n      clickProps = {\n        onClick: onClick\n      };\n    }\n\n    return /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", _extends({\n      d: d\n    }, hoverProps, clickProps)));\n  };\n\n  var renderPoints = function renderPoints() {\n    return (values || []).filter(function (_ref9) {\n      var value = _ref9.value;\n      return value[1] !== undefined;\n    }).map(function (valueArg, index) {\n      var valueColor = valueArg.color,\n          label = valueArg.label,\n          valueOnHover = valueArg.onHover,\n          valueOpacity = valueArg.opacity,\n          valueThickness = valueArg.thickness,\n          value = valueArg.value,\n          valueRest = _objectWithoutPropertiesLoose(valueArg, [\"color\", \"label\", \"onHover\", \"opacity\", \"thickness\", \"value\"]);\n\n      var key = \"p-\" + index;\n      var hoverProps;\n\n      if (valueOnHover) {\n        hoverProps = {\n          onMouseOver: function onMouseOver() {\n            return valueOnHover(true);\n          },\n          onMouseLeave: function onMouseLeave() {\n            return valueOnHover(false);\n          }\n        };\n      }\n\n      var clickProps;\n\n      if (onClick) {\n        clickProps = {\n          onClick: onClick\n        };\n      }\n\n      var width = valueThickness ? parseMetricToNum(theme.global.edgeSize[valueThickness] || valueThickness) : strokeWidth;\n\n      var renderPoint = function renderPoint(valueX, valueY) {\n        var props = _extends({}, hoverProps, clickProps, valueRest);\n\n        var _valueToCoordinate = valueToCoordinate(valueX, valueY),\n            cx = _valueToCoordinate[0],\n            cy = _valueToCoordinate[1];\n\n        var off = width / 2;\n        if (point === 'circle' || !point && round) return /*#__PURE__*/React.createElement(\"circle\", _extends({\n          cx: cx,\n          cy: cy,\n          r: off\n        }, props));\n        var d;\n        if (point === 'diamond') d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + cy + \" L \" + cx + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + cy + \" Z\";else if (point === 'star') {\n          var off1 = off / 3;\n          var off2 = off1 * 2;\n          d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx - off2) + \" \" + (cy + off) + \" L \" + (cx + off) + \" \" + (cy - off1) + \" L \" + (cx - off) + \" \" + (cy - off1) + \" L \" + (cx + off2) + \" \" + (cy + off) + \" Z\";\n        } else if (point === 'triangle') d = \"M \" + cx + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + (cy + off) + \" Z\";else if (point === 'triangleDown') d = \"M \" + (cx - off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy - off) + \" L \" + cx + \" \" + (cy + off) + \" Z\"; // square\n        else d = \"M \" + (cx - off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy - off) + \" L \" + (cx + off) + \" \" + (cy + off) + \" L \" + (cx - off) + \" \" + (cy + off) + \" Z\";\n        return /*#__PURE__*/React.createElement(\"path\", {\n          d: d\n        });\n      };\n\n      return /*#__PURE__*/React.createElement(\"g\", {\n        key: key,\n        stroke: \"none\",\n        fill: valueColor ? normalizeColor(valueColor, theme) : undefined,\n        opacity: valueOpacity && theme.global.opacity[valueOpacity] || valueOpacity\n      }, /*#__PURE__*/React.createElement(\"title\", null, label), renderPoint(value[0], value[1]), value[2] !== undefined && renderPoint(value[0], value[2]));\n    });\n  };\n\n  var contents;\n\n  if (type === 'bar') {\n    contents = renderBars();\n  } else if (type === 'line') {\n    contents = renderLine();\n  } else if (type === 'area') {\n    contents = renderArea();\n  } else if (type === 'point') {\n    contents = renderPoints();\n  }\n\n  var viewBox = viewBounds.join(' ');\n  var colorName;\n\n  if (!useGradient) {\n    if (color && color.color) colorName = color.color;else if (color) colorName = color;else if (theme.chart && theme.chart.color) colorName = theme.chart.color;\n  }\n\n  var opacity = propsOpacity || color && color.opacity ? theme.global.opacity[propsOpacity || color.opacity] || propsOpacity || color.opacity : undefined;\n  var stroke;\n\n  if (type !== 'point') {\n    if (useGradient) stroke = gradientMaskColor;else stroke = normalizeColor(colorName, theme);\n  } else stroke = 'none';\n\n  var fill;\n\n  if (type === 'point' || type === 'area') {\n    if (useGradient) fill = gradientMaskColor;else fill = normalizeColor(colorName, theme);\n  } else fill = 'none';\n\n  var drawing = /*#__PURE__*/React.createElement(\"g\", {\n    stroke: stroke,\n    strokeWidth: type !== 'point' ? strokeWidth : undefined,\n    fill: fill,\n    strokeLinecap: round ? 'round' : 'butt',\n    strokeLinejoin: round ? 'round' : 'miter',\n    opacity: opacity\n  }, contents);\n  var defs;\n  var gradientRect;\n\n  if (useGradient && size[1]) {\n    var uniqueGradientId = color.map(function (element) {\n      return element.color;\n    }).join('-');\n    var gradientId = uniqueGradientId + \"-\" + id + \"-gradient\";\n    var maskId = uniqueGradientId + \"-\" + id + \"-mask\";\n    defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n      id: gradientId,\n      x1: 0,\n      y1: 0,\n      x2: 0,\n      y2: 1\n    }, color.sort(function (c1, c2) {\n      return c2.value - c1.value;\n    }).map(function (_ref10) {\n      var value = _ref10.value,\n          gradientColor = _ref10.color;\n      return /*#__PURE__*/React.createElement(\"stop\", {\n        key: value,\n        offset: // TODO:\n        (size[1] - (value - bounds[1][0]) * scale[1]) / size[1],\n        stopColor: normalizeColor(gradientColor, theme)\n      });\n    })), /*#__PURE__*/React.createElement(\"mask\", {\n      id: maskId\n    }, drawing));\n    gradientRect = /*#__PURE__*/React.createElement(\"rect\", {\n      x: viewBounds[0],\n      y: viewBounds[1],\n      width: viewBounds[2],\n      height: viewBounds[3],\n      fill: \"url(#\" + gradientId + \")\",\n      mask: \"url(#\" + maskId + \")\"\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(StyledChart, _extends({\n    ref: containerRef,\n    id: id,\n    \"aria-label\": a11yTitle,\n    viewBox: viewBox,\n    preserveAspectRatio: \"none\",\n    width: size === 'full' ? '100%' : size[0],\n    height: size === 'full' ? '100%' : size[1],\n    typeProp: type // prevent adding to DOM\n\n  }, rest), defs, useGradient ? gradientRect : drawing);\n});\nChart.displayName = 'Chart';\nvar ChartDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  ChartDoc = require('./doc').doc(Chart); // eslint-disable-line global-require\n}\n\nvar ChartWrapper = ChartDoc || Chart;\nexport { ChartWrapper as Chart };"]},"metadata":{},"sourceType":"module"}